# ChildrensPlayAreas_public

This project generates the NYC Parks **Children's Play Areas (CPA) dataset** (as points, not polygons). These points are centroids of clusters of play equipment meant to be used by children (notably, excluding basketball courts, adult equipment and other amenities currently *included* in Parks' *Playground* data set).


## Data Product Overview: Children's Play Areas (CPAs)

Children's Play Areas (CPAs) are points that mark clusters of play units
within NYC Parks. While otherwise known as playgrounds, this term is
deliberately avoided because properties or subproperties named as playgrounds may
contain more than just play units (e.g., adult fitness equipment,
basketball/handball courts, etc.), or may not contain play units at all.

CPA points are the centroids (geometric centers) of all play units that are
within physical view of each other within a park or subproperty. If there are
objects obstructing view of one play unit from another within a park or
subproperty (e.g. a building, fence, large field, etc.) then multiple CPA points
are created in that park or subproperty. The CPA points are generated by a
script developed by Innovation & Performance Management (IPM). In order for this
data product to remain current, the script is scheduled to run daily whereby CPA
attributes and source data from which they are derived remain consistent and in
sync.

Detailed documentation of the script and source code can be viewed in a Jupyter notebook on [GitHub](https://github.com/NYC-Parks/ChildrensPlayAreas/blob/master/script_folder/daily/generate_cpa_20190926.ipynb) or [GitLab](http://ubuntu-virtual/root/childrensplayareas/blob/master/script_folder/daily/generate_cpa_20190926.ipynb).

### Purpose of this document

The purpose of this data product overview is to identify and describe the
attributes associated with CPAs. Since many CPA attributes are derived from
other data sources, this document also identifies those source systems, tables,
and fields, as well as the owners of those source fields. In case there is an
inquiry regarding where the name, location, or any other attribute of a CPA
comes from, owners of the source data should be contacted. Finally, this
document identifies both the owners of as well as groups/divisions/individuals
most likely to consume this CPA data product. Primary consumers will likely be
the most capable parties of spotting errors, inconsistencies, missing
information, etc., and can contribute to the ongoing data quality checks of this
product.

### Data Product Owners

IPM

### Primary Data Product Consumers

Digital Media

### List of all CPA attributes

**system**, **GISpropNum**, **OMPpropID**, **grp, department**, **name**,
**additionalNameInfo**, **location**, **additionalLocationInfo**, **rules**,
**accessibility**, **accessibilityLevel**, **featureStatus**,
**statusChangeDate**, **inheritedFrom, tmpCPAID, notes, shape**

### Attributes derived from other data sets

**GISpropNum**, **OMPpropID, department, name** and **location** fields are
inherited from either the *Property, Playground, Zone,* or *Greenstreet* layer.
The **inheritedFrom** attribute specifies which layer they are inherited from.

**rules** is inherited from the *Sign* layer.

**accessibility** and **accessibilityLevel** are inherited from a [json feed](http://www.nycgovparks.org/bigapps/DPR_Playgrounds_001.json).

### Attributes unique to CPAs

The **system**, **grp, additionalNameInfo**, **additionalLocationInfo,
featureStatus**, **statusChangeDate**, **inheritedFrom, tmpCPAID, notes,** and
**shape** fields are generated by the script that creates the CPA points.


## Attribute Table
| Attribute              | Description                                                                                                                                                                                                                                                                                                                                            | Generative Process                                                                                                                                                                                                                                                                     | Derived from Another Source | Source Data Owner / Modifier         |
|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|--------------------------------------|
| **system**                 | Unique ID of the CPA                                                                                                                                                                                                                                                                                                                                   | Created when a new CPA is generated or when an existing CPA needs to have an updated ID (e.g. because of a change in source data)                                                                                                                                                      | No                          | IPM                                  |
| **GISpropNum**             | ID of the property that contains the CPA                                                                                                                                                                                                                                                                                                               | Inherited from the **GISPROPNUM** field in either *Property, Playground, Zone,* or *Greenstreet.*  <br><br>**inheritedFrom** field indicates which one.                                                                                                                                                | Yes                         | Planning / Parklands, OMP            |
| **OMPpropID**              | OMP ID of property or sub-property that contains the CPA                                                                                                                                                                                                                                                                                               | Inherited from the **OMPPROPID** field in either *Property, Playground, Zone,* or *Greenstreet.*  <br><br>**inheritedFrom** field indicates which one.                                                                                                                                                | Yes                         | OMP                                  |
| **grp**                    | Group ID (*1* or *2*) of cluster of play units within a single park or sub-property (i.e. when more than one CPA is created within a park or sub-property)                                                                                                                                                                                             | Generated by script                                                                                                                                                                                                                                                                    | No                          | IPM                                  |
| **department**             | The Parks maintenance district within which CPA resides                                                                                                                                                                                                                                                                                                | Inherited from the **DEPARTMENT** field in either *Property, Playground, Zone,* or *Greenstreet.*  <br><br>**inheritedFrom** field indicates which one.                                                                                                                                                | Yes                         | Planning / Parklands, OMP            |
| **name**                   | Name of the property or sub-property that contains the CPA                                                                                                                                                     | Inherited from the appropriate field in either <ul><li>*Property* (**SIGNNAME**)</li><li>*Playground* (**Site_Name**)</li><li>*Zone* (**SITENAME**)</li><li>*Greenstreet* (**DESCRIPTION)**</li></ul> **inheritedFrom** field indicates which one. <br>See **name** section below for more details.                                                                                                       | Yes                         | Planning / Parklands, OMP, Marketing |
| **additionalNameInfo**     | Cardinality (e.g. *East* or *West*) added to CPA name when one CPA point is split into                                                                                                                         | *NULL* for most CPAs. Cardinality added by IPM in cases where single CPA point is split into two or more.                                                                                                                                                                    | No                          | IPM                                  |
| **location**               | Closest cross streets to CPA                                                                                                                                                                                                                                                                                                                           | Inherited from the **LOCATION** field in either *Property, Playground, Zone,* or *Greenstreet.*  <br><br>**inheritedFrom** field indicates which one                                                                                                                                                   | Yes                         | Planning / Parklands, OMP            |
| **additionalLocationInfo** | Cardinality or other detail added to CPA location when one CPA point is split into two or more                                                                                                                                                                                                                                                         | *NULL* for most CPAs. Additional location detail added by IPM in cases where single CPA point is split into two or more                                                                                                                                                                | No                          | IPM                                  |
| **rules**                  | Whether adults are allowed within the premises of CPA                                                                                                                                                                                                                                                                                                  | Inherited from the **SubType** field in *Sign* <br><br>See **rules** section below for more details                                                                                                                                                                                                | Yes                         | Marketing, IT GIS                    |
| **accessibility**          | Whether the play units associated with CPA are ADA compliant (*Yes* or *No)*                                                                                                                                                                                                                                                                           | Inherited from [json feed](http://www.nycgovparks.org/bigapps/DPR_Playgrounds_001.json) <br><br>See **accessibility** section below for more details                                                                                                                                                    | Yes                         | Capital                              |
| **accessibilityLevel**     | Level of accessibility, ranging from 1-4:  <ul><li>**Level 1:** playgrounds for all children</li><li>**Level 2:** accessible playgrounds with ramped play equipment and universally accessible swings</li><li>**Level 3:** accessible playgrounds with universally accessible swings</li><li>**Level 4:** accessible playgrounds with transfer platforms and ground level play features</li>                                                                                   | Inherited from [json feed](http://www.nycgovparks.org/bigapps/DPR_Playgrounds_001.json) <br><br>See **accessibility** section below for more details                                                                                                                                                    | Yes                         | Capital                              |
| **featureStatus**          | Status (*active* or *archived)* of the CPA                                                                                                                                                                                                                                                                                                             | If underlying data changes such that CPA **system** ID needs to be archived, this field is manually updated<br><br>Default is *active*                                                                                                                                                                                                                                                                    | No                          | IPM                                  |
| **statusChangeDate**       | Date that CPA **featureStatus** is changed from *active* to *archived*                                                                                                                                                                                                                                                                                 | Upon change of **featureStatus** of CPA, date is populated <br><br>Default is *NULL*                                                                                                                                                                                                          | No                          | IPM                                  |
| **inheritedFrom**          | Indicates which layer CPA attributes such as **name**, **location** are inherited from (*Property, Playground, Zone,* or *Greestreet*)                                                                                                                                                                                                                 | Generated by the script                                                                                                                                                                                                                                                                | No                          | IPM                                  |
| **tmpCPAID**               | Temporary unique ID of CPA, generated by the script, for the purpose of uniquely tying CPA to underlying play units in the play unit reference table *(dbo.tbl_playunit_cpa_ref*)                                                                                                                                                                      | Generated by the script                                                                                                                                                                                                                                                                | No                          | IPM                                  |
| **notes**                  | Description of why CPA **featureStatus** is changed from *active* to *archived*                                                                                                                                                                                                                                                                        | Script prompts entry when needed <br><br>Default is *NULL*                                                                                                                                                                                                                                     | No                          | IPM                                  |
| **shape**                  | Point location of the new CPA, in most cases is the geometric center of associated play units                                                                                                                                                                                                                                                          | In most cases, the correct point is auto-generated by the script as a centroid of a cluster of play units. When exceptions occur (e.g. point lands outside of Parks property, point lands on top of building, athletic field, etc.) the situation is flagged and is resolved manually. | No                          | IPM                                  |

## Name Attribute: Further Details

The Name Committee, led by the Commissioner's office, vets and approves changes
to park or sub-property names. After sign-off from the Commissioner, Mark
McCormack (Commissioner's office) informs the Agency Chief of Staff, Planning,
the Borough Commissioners' offices, Digital Media, OMP, Art & Antiquities,
Government Relations, and IT of the change.

Upon sign-off, Antonios Michelakis (AM) from Planning and Alex Butler (AB) from OMP update the
fields in appropriate Parks GIS layers (*Property, Playground, Zone*, or
*Greenstreet*). Every time the CPA script is run, those changes are inherited by
the CPA dataset.

The **SIGNNAME** attribute in the *Property* feature class is updated by AM.

The **Site_Name** attribute in the *Playground* feature class is updated by AB.

The **SITENAME** attribute in the *Zone* feature class is updated by AB.

The **DESCRIPTION** attribute in the *Greenstreet* feature class is updated by (data owner?).

*In the future, if data flow/business processes permit the name attribute to be
updated in one place, the CPA script will need to be updated accordingly.*

## Rules Attribute: Further Details

The Marketing division manages the *Sign* dataset for the agency, which includes
rules for public usage of every park, such as hours open, who is allowed,
whether barbecuing is allowed, etc.

For the CPA script, **rules** are inherited from *DWH.dbo.TBL_ParksGIS_Sign* in the
following way:

1.  For each CPA point, a 150 ft. buffer is created.

2.  This buffer is spatially intersected with the *Sign* GIS layer.

3.  The CPA dataset's **rules** field then inherits the **AmenityType** value from
    the *Sign* GIS layer (currently, the only updated version of this layer lives in the DWH db on data.parks. *Sign* in ParksGIS is not updated). Buffers that do not intersect with any sign are given
    a value of *UNKNOWN*. Buffers that intersect with multiple signs take all
    signs into consideration when generating the **rule** (e.g. *Adults allowed
    in some locations*).

Currently, changes to the *Sign* dataset are not automatically updated.
Marketing uses an ArcGIS web app to document signs installed in parks - the team
typically makes updates in the spring and fall of each year. As these edits are
stored in the cloud in the ArcGIS web app, the dataset needs to be manually
exported by IT GIS from the cloud and into the ParksGIS database. When requested
by Marketing, IT GIS updates the *Sign* layer in ParksGIS with the latest
feature class from the web app. These changes are inherited by CPAs the next
time the CPA script is run.

The CPA script pulls values from the following fields in the *Sign* layer to
create CPA **rules**:

-   **Shape** (for the location of the sign)

-   **AmenityType** (type of sign):

    -   *Playground - Adults Allowed (Code 2600)*

    -   *Playground - Children Only (Code 2601)*

    -   *Combo: Playground / Court (Code 2602)*, which allows both children and
        adults

-   **MountingSurface**

-   **SignStatus** (*Surveyed* or *Installed*)

See the source code for further details on how **rules** are generated from the
above fields for CPAs.

## Accessibility Attributes: Further Details

**accessibility** information (*Yes/No, Level*) is currently maintained by
Christopher Noel in Capital, and updated for the Parks website by Digital Media.
This source data lives [here](http://www.nycgovparks.org/bigapps/DPR_Playgrounds_001.json) and is inherited
by CPAs via the script using spatial joins.

*Note: The accessibility and accessibilityLevel attributes will be expanded in
2020 and beyond, as IPM is working with Christopher Noel/Capital and with
Digital Media to introduce additional accessibility details at the play unit
level, such that the public can find CPAs based on specific accessibility
attributes they desire. This is currently an ongoing project that will update
and overhaul the existing accessibility attributes*.
